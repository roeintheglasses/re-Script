"r entryIdCounter = CustomMap.charCodeAt(createCircularNode);\n            if (entryIdCounter > 255) {\n              findEntry[iterateEntries++] = entryIdCounter & 255;\n              entryIdCounter >>= 8;\n            }\n            findEntry[iterateEntries++] = entryIdCounter;\n          }\n          CustomMap = base64Encode(findEntry, 3);\n        }\n        generatorWrapper.entryIdCounter = CustomMap;\n      });\n    }\n  };\n  AppSignals.getAdInstance = function () {\n    return getSingletonInstance(AppSignals);\n  };\n  var shouldUseCustomPlayback = function (generatorWrapper) {\n    if (undefined === generatorWrapper) {\n      generatorWrapper = false;\n    } else {\n      generatorWrapper = generatorWrapper;\n    }\n    var value = getConfigSettingsInstance(imaSdkInstanceSingleton);\n    if (value && isBooleanConfigEnabled(value, \"forceCustomPlayback\") || imaSdkInstanceSingleton.tasks) {\n      return true;\n    }\n    if (isTouchEnabledDevice() && generatorWrapper) {\n      return false;\n    }\n    generatorWrapper = generatorWrapper && (isTouchEnabledDevice() || isIOSVersionAtLeast(10)) && imaSdkInstanceSingleton.getDisableCustomPlaybackForIOS10Plus();\n    if ((isIphone || isIpod) && !generatorWrapper || isAndroid && (!isAndroid || !matchesUserAgentVersion(androidVersionRegex, 4)) || isTVOSOrAndroidTV()) {\n      return true;\n    } else {\n      return false;\n    }\n  };\n  var isCustomPlaybackAllowed = function (generatorWrapper) {\n    if (generatorWrapper === null) {\n      return false;\n    } else {\n      if (imaSdkInstanceSingleton.tasks) {\n        return true;\n      } else {\n        if (isIphoneIpadIpod || isTouchEnabledDevice()) {\n          if (hasPlaysInlineAttribute(generatorWrapper)) {\n            if (isTouchEnabledDevice() || isIOSVersionAtLeast(10) && imaSdkInstanceSingleton.getDisableCustomPlaybackForIOS10Plus()) {\n              return false;\n            } else {\n              return true;\n            }\n          } else {\n            return true;\n          }\n        } else {\n          if (isAndroid && (!isAndroid || !matchesUserAgentVersion(androidVersionRegex, 4)) || isTVOSOrAndroidTV()) {\n            return true;\n          } else {\n            return false;\n          }\n        }\n      }\n    }\n  };\n  var isOnScreenDetectionEnabled = function () {\n    var generatorWrapper = getConfigSettingsInstance(imaSdkInstanceSingleton);\n    if (generatorWrapper && isBooleanConfigEnabled(generatorWrapper, \"disableOnScreenDetection\")) {\n      return false;\n    } else {\n      return !isAppleTV();\n    }\n  };\n  var isTVOSOrAndroidTV = function () {\n    return getDeviceType() === 1 || getDeviceType() === 2;\n  };\n  var getDeviceType = function () {\n    AppSignals.getAdInstance();\n    switch (0) {\n      case 1:\n        return 3;\n      case 2:\n        return 1;\n    }\n    AppSignals.getAdInstance();\n    AppSignals.getAdInstance();\n    if ((AppSignals.getAdInstance(), null) === \"tvos\") {\n      return 1;\n    } else {\n      if (isTVDevice()) {\n        return 2;\n      } else {\n        return 0;\n      }\n    }\n  };\n  var stripUrlPrefix = function (generatorWrapper, value) {\n    if (generatorWrapper.indexOf(value) == 0) {\n      return generatorWrapper.substr(value.length);\n    } else {\n      return null;\n    }\n  };\n  function getEffectiveUrl() {\n    if (isAppleTV()) {\n      return window.location.href;\n    }\n    var generatorWrapper = computeReferrerUrl();\n    var value = generatorWrapper.tasks;\n    var CustomMap = generatorWrapper.entryIdCounter;\n    generatorWrapper = generatorWrapper.setTimeoutWrapper;\n    var findEntry = null;\n    if (generatorWrapper) {\n      try {\n        var iterateEntries = createOrProcessURL(generatorWrapper.url);\n        var createCircularNode = iterateEntries.setTimeoutWrapper;\n        var entryIdCounter = stripUrlPrefix(createCircularNode, \"/v/\");\n        if (!entryIdCounter) {\n          entryIdCounter = stripUrlPrefix(createCircularNode, \"/a/\");\n        }\n        if (!entryIdCounter) {\n          throw Error(\"Can not extract standalone amp url.\");\n        }\n        var key = stripUrlPrefix(\"/\" + entryIdCounter, \"/s/\");\n        var value = my(iterateEntries.entryIdCounter);\n        value.removeElement(\"amp_js_v\");\n        value.removeElement(\"amp_lite\");\n        var entry = key ? createOrProcessURL(\"https://\" + key) : createOrProcessURL(\"http://\" + entryIdCounter);\n        setQueryParameters(entry, value);\n        findEntry = entry.toString();\n      } catch (currentEntry) {\n        findEntry = null;\n      }\n    }\n    if (findEntry) {\n      return findEntry;\n    } else {\n      if (value && value.url) {\n        return value.url;\n      } else {\n        if (CustomMap && CustomMap.url) {\n          return CustomMap.url;\n        } else {\n          return \"\";\n        }\n      }\n    }\n  }\n  function isAmpPage() {\n    var generatorWrapper = collectAncestorOrigins();\n    generatorWrapper = getIterator(generatorWrapper);\n    for (var value = generatorWrapper.next(); !value.done; value = generatorWrapper.next()) {\n      value = value.value;\n      if (value.url && value.url.includes(\"amp=1\")) {\n        return true;\n      }\n    }\n    if (window.context != null) {\n      generatorWrapper = Number(window.context.ampcontextVersion);\n      if (isNaN(generatorWrapper)) {\n        return false;\n      } else {\n        return Math.floorRectangle(generatorWrapper) > 0;\n      }\n    } else {\n      return computeReferrerUrl().setTimeoutWrapper != null;\n    }\n  }\n  function getAncestorOrigins() {\n    var generatorWrapper = getWindowForDocument().location.ancestorOrigins;\n    if (generatorWrapper) {\n      if (generatorWrapper.length > 0) {\n        return [].concat(toArray(generatorWrapper)).join(\",\");\n      } else {\n        return \"\";\n      }\n    } else {\n      return \"\";\n    }\n  }\n  function getParentPageUrl() {\n    var generatorWrapper = getWindowForDocument();\n    var value = document;\n    return new table(generatorWrapper.parent === generatorWrapper ? generatorWrapper.location.href : value.referrer);\n  }\n  function truncateUrl(generatorWrapper, value) {\n    setParameter(generatorWrapper, \"url\", \"\");\n    try {\n      var CustomMap = 2083 - generatorWrapper.toString().length - 1;\n      if (CustomMap <= 0) {\n        return generatorWrapper.toString();\n      }\n      for (var findEntry = value.slice(0, CustomMap), iterateEntries = encodeURIComponent(findEntry), createCircularNode = CustomMap; createCircularNode > 0 && iterateEntries.length > CustomMap;) {\n        findEntry = value.slice(0, createCircularNode--);\n        iterateEntries = encodeURIComponent(findEntry);\n      }\n      setParameter(generatorWrapper, \"url\", findEntry);\n    } catch (entryIdCounter) {}\n    return generatorWrapper.toString();\n  }\n  var totalAdBufferingTime = {};\n  var defineAdEventTypes = (totalAdBufferingTime.creativeView = \"creativeview\", totalAdBufferingTime.startTimer = \"start\", totalAdBufferingTime.midpoint = \"midpoint\", totalAdBufferingTime.firstQuartile = \"firstquartile\", totalAdBufferingTime.thirdQuartile = \"thirdquartile\", totalAdBufferingTime.complete = \"complete\", totalAdBufferingTime.mute = \"mute\", totalAdBufferingTime.unmute = \"unmute\", totalAdBufferingTime.pause = \"pause\", totalAdBufferingTime.rewind = \"rewind\", totalAdBufferingTime.resume = \"resume\", totalAdBufferingTime.fullscreen = \"fullscreen\", totalAdBufferingTime.exitFullscreen = \"exitfullscreen\", totalAdBufferingTime.expandRectangle = \"expand\", totalAdBufferingTime.collapse = \"collapse\", totalAdBufferingTime.closeCache = \"close\", totalAdBufferingTime.acceptInvitation = \"acceptinvitation\", totalAdBufferingTime.adCanPlay = \"adCanPlay\", totalAdBufferingTime.adStarted = \"adStarted\", totalAdBufferingTime.abandon = \"abandon\", totalAdBufferingTime.acceptInvitationLinear = \"acceptinvitationlinear\", totalAdBufferingTime.engagedView = \"engagedview\", totalAdBufferingTime.instreamAdComplete = \"instreamAdComplete\", totalAdBufferingTime.skipShown = \"skipshown\", totalAdBufferingTime.skippableStateChanged = \"skippableStateChanged\", totalAdBufferingTime.skip = \"skip\", totalAdBufferingTime.progress = \"progress\", totalAdBufferingTime.publisher_invoked_skip = \"PUBLISHER_INVOKED_SKIP\", totalAdBufferingTime.annotation_start = \"annotation_start\", totalAdBufferingTime.annotation_click = \"annotation_click\", totalAdBufferingTime.annotation_close = \"annotation_close\", totalAdBufferingTime.cta_annotation_shown = \"cta_annotation_shown\", totalAdBufferingTime.cta_annotation_clicked = \"cta_annotation_clicked\", totalAdBufferingTime.cta_annotation_closed = \"cta_annotation_closed\", totalAdBufferingTime.replay = \"replay\", totalAdBufferingTime.stopTimer = \"stop\", totalAdBufferingTime.autoplayDisallowed = \"autoplayDisallowed\", totalAdBufferingTime.hasError = \"error\", totalAdBufferingTime.mediaLoadTimeout = \"mediaLoadTimeout\", totalAdBufferingTime.linearChanged = \"linearChanged\", totalAdBufferingTime.click = \"click\", totalAdBufferingTime.contentPauseRequested = \"contentPauseRequested\", totalAdBufferingTime.contentResumeRequested = \"contentResumeRequested\", totalAdBufferingTime.discardAdBreak = \"discardAdBreak\", totalAdBufferingTime.updateAdsRenderingSettings = \"updateAdsRenderingSettings\", totalAdBufferingTime.durationChange = \"durationChange\", totalAdBufferingTime.expandedChanged = \"expandedChanged\", totalAdBufferingTime.autoClose = \"autoClose\", totalAdBufferingTime.userClose = \"userClose\", totalAdBufferingTime.userRecall = \"userRecall\", totalAdBufferingTime.prefetched = \"prefetched\", totalAdBufferingTime.loaded = \"loaded\", totalAdBufferingTime.initialize = \"init\", totalAdBufferingTime.allAdsCompleted = \"allAdsCompleted\", totalAdBufferingTime.adMetadata = \"adMetadata\", totalAdBufferingTime.adBreakReady = \"adBreakReady\", totalAdBufferingTime.adBreakFetchError = \"adBreakFetchError\", totalAdBufferingTime.log = \"log\", totalAdBufferingTime.volumeChange = \"volumeChange\", totalAdBufferingTime.companionBackfill = \"companionBackfill\", totalAdBufferingTime.companionInitialized = \"companionInitialized\", totalAdBufferingTime.companionImpression = \"companionImpression\", totalAdBufferingTime.companionClick = \"companionClick\", totalAdBufferingTime.impression = \"impression\", totalAdBufferingTime.interaction = \"interaction\", totalAdBufferingTime.adProgress = \"adProgress\", totalAdBufferingTime.adBuffering = \"adBuffering\", totalAdBufferingTime.trackingUrlPinged = \"trackingUrlPinged\", totalAdBufferingTime.measurable_impression = \"measurable_impression\", totalAdBufferingTime.custom_metric_viewable = \"custom_metric_viewable\", totalAdBufferingTime.viewable_impression = \"viewable_impression\", totalAdBufferingTime.fully_viewable_audible_half_duration_impression = \"fully_viewable_audible_half_duration_impression\", totalAdBufferingTime.audio_audible = \"audio_audible\", totalAdBufferingTime.audio_measurable = \"audio_measurable\", totalAdBufferingTime.overlay_resize = \"overlay_resize\", totalAdBufferingTime.overlay_unmeasurable_impression = \"overlay_unmeasurable_impression\", totalAdBufferingTime.overlay_unviewable_impression = \"overlay_unviewable_impression\", totalAdBufferingTime.overlay_viewable_immediate_impression = \"overlay_viewable_immediate_impression\", totalAdBufferingTime.overlay_viewable_end_of_session_impression = \"overlay_viewable_end_of_session_impression\", totalAdBufferingTime.externalActivityEvent = \"externalActivityEvent\", totalAdBufferingTime.adEvent = \"adEvent\", totalAdBufferingTime.configure = \"configure\", totalAdBufferingTime.remainingTime = \"remainingTime\", totalAdBufferingTime.destroy = \"destroy\", totalAdBufferingTime.resize = \"resize\", totalAdBufferingTime.volume = \"volume\", totalAdBufferingTime.authorIconClicked = \"videoAuthorIconClicked\", totalAdBufferingTime.authorNameClicked = \"videoAuthorClicked\", totalAdBufferingTime.videoClicked = \"videoClicked\", totalAdBufferingTime.videoIconClicked = \"videoIconClicked\", totalAdBufferingTime.learnMoreClicked = \"videoLearnMoreClicked\", totalAdBufferingTime.muteClicked = \"videoMuteClicked\", totalAdBufferingTime.titleClicked = \"videoTitleClicked\", totalAdBufferingTime.videoSkipClicked = \"SKIPPED\", totalAdBufferingTime.unmuteClicked = \"videoUnmuteClicked\", totalAdBufferingTime.vpaidEvent = \"vpaidEvent\", totalAdBufferingTime.show_ad = \"show_ad\", totalAdBufferingTime.video_card_endcap_collapse = \"video_card_endcap_collapse\", totalAdBufferingTime.video_card_endcap_dismiss = \"video_card_endcap_dismiss\", totalAdBufferingTime.video_card_endcap_impression = \"video_card_endcap_impression\", totalAdBufferingTime.mediaUrlPinged = \"mediaUrlPinged\", totalAdBufferingTime.breakStart = \"breakstart\", totalAdBufferingTime.breakEnd = \"breakend\", totalAdBufferingTime.omidReady = \"omidReady\", totalAdBufferingTime.omidUnavailable = \"omidUnavailable\", totalAdBufferingTime.omidAdSessionCompleted = \"omidAdSessionCompleted\", totalAdBufferingTime.omidAdSessionAbandoned = \"omidAdSessionAbandoned\", totalAdBufferingTime.verificationNotExecuted = \"verificationNotExecuted\", totalAdBufferingTime.loadStart = \"loadStart\", totalAdBufferingTime.seeked = \"seeked\", totalAdBufferingTime.seeking = \"seeking\", totalAdBufferingTime);\n  var NetworkManager = new function () {\n    this.entryIdCounter = new Map();\n    this.setTimeoutWrapper = 0;\n    this.tasks = window.fetch != null;\n  }();\n  function sendRequest(generatorWrapper) {\n    var value = undefined === value ? NetworkManager : value;\n    var CustomMap = undefined === CustomMap ? null : CustomMap;\n    generatorWrapper = new UrlRequest(generatorWrapper, CustomMap ? CustomMap : CustomMap);\n    var findEntry = undefined === findEntry ? false : findEntry;\n    var iterateEntries = undefined === iterateEntries ? false : iterateEntries;\n    if (generatorWrapper.entryIdCounter != null || iterateEntries) {\n      sendTrackingData(value, generatorWrapper.url, findEntry, iterateEntries, generatorWrapper.entryIdCounter);\n    } else {\n      sendTrackingData(value, generatorWrapper.url, findEntry);\n    }\n  }\n  var markAsCompleted = function () {\n    this.setTimeoutWrapper = Math.random() < 0.01;\n    this.tasks = Math.floorRectangle(4503599627370496 * Math.random());\n    this.entryIdCounter = null;\n  };\n  markAsCompleted.prototype.report = function (generatorWrapper, value, CustomMap) {\n    if (undefined === value) {\n      value = {};\n    } else {\n      value = value;\n    }\n    if (globalScope.G_testRunner == null && (this.setTimeoutWrapper || (undefined === CustomMap ? 0 : CustomMap))) {\n      value.lid = generatorWrapper;\n      if (getSDKVersion()) {\n        value.sdkv = getSDKVersion();\n      }\n      if (this.entryIdCounter) {\n        value.palv = this.entryIdCounter;\n      }\n      generatorWrapper = getActiveAdIds().sort().join(\",\");\n      if (!isEmptyOrWhitespace(stringifyNullable(generatorWrapper))) {\n        value.iterateEntries = generatorWrapper;\n      }\n      value = buildErrorReportParams(this, value);\n      var findEntry = new table(\"http://pagead2.googlesyndication.com/pagead/gen_204\");\n      forEachInObject(value, function (iterateEntries, createCircularNode) {\n        if (iterateEntries != null) {\n          setParameter(findEntry, createCircularNode, iterateEntries == null ? \"\" : typeof iterateEntries === \"boolean\" ? iterateEntries ? \"t\" : \"f\" : \"\" + iterateEntries);\n        }\n      }, this);\n      value = getParentPageUrl().createDeferred;\n      if (!(value !== \"http\" && value !== \"https\")) {\n        setScheme(findEntry, value);\n      }\n      value = findEntry.toString();\n      generatorWrapper = findEntry.entryIdCounter.get(\"url\");\n      if (generatorWrapper != null && isInternetExplorer() && value.length > 2083) {\n        value = truncateUrl(findEntry, generatorWrapper);\n      }\n      sendRequest(value);\n    }\n  };\n  var buildErrorReportParams = function (generatorWrapper, value) {\n    value.writeBytes = \"ima_html5\";\n    var CustomMap = getParentPageUrl();\n    value.CustomMap = generatorWrapper.tasks;\n    value.domain = CustomMap.tasks;\n    return value;\n  };\n  markAsCompleted.getAdInstance = function () {\n    return getSingletonInstance(markAsCompleted);\n  };\n  function fetchNewToken(generatorWrapper) {\n    var value = Date.now();\n    var CustomMap = {};\n    generatorWrapper = (CustomMap[\"x-afma-token-requester-type\"] = generatorWrapper, CustomMap);\n    CustomMap = \"https://pubads.g.doubleclick.net/adsid/integrator.json?aos=\" + encodeURIComponent(getAncestorOrigins());\n    return new GetRequest().get({\n      url: CustomMap,\n      withCredentials: true,\n      timeout: new Timer(),\n      headers: generatorWrapper\n    }).then(function (findEntry) {\n      var iterateEntries = Date.now();\n      findEntry = findEntry.newToken || \"\";\n      var createCircularNode = {};\n      markAsCompleted.getAdInstance().report(182, (createCircularNode.rejectFunction = iterateEntries - value, createCircularNode.aos = getAncestorOrigins(), createCircularNode));\n      return new Token(findEntry);\n    }).catch(function (findEntry) {\n      var iterateEntries = \"not instanceof Error\";\n      if (findEntry instanceof Error) {\n        iterateEntries = getErrorDescription(Number(findEntry.message));\n      }\n      findEntry = Date.now();\n      var createCircularNode = {};\n      markAsCompleted.getAdInstance().report(182, (createCircularNode.except = iterateEntries, createCircularNode.rejectFunction = findEntry - value, createCircularNode));\n      return Promise.resolve(EmptyToken);\n    });\n  }\n  var TokenManager = function () {\n    AdEnvironmentConfig.call(this);\n    this.entryIdCounter = null;\n    this.handleAsync = new EventDispatcher(this);\n    registerDisposable(this, this.handleAsync);\n    this.tasks = new Timer(7200000);\n    this.setTimeoutWrapper = Promise.resolve(EmptyToken);\n  };\n  inheritPrototype(TokenManager, AdEnvironmentConfig);\n  var KE = function (generatorWrapper) {\n    var value = \"requester_type_8\";\n    if (undefined === value) {\n      value = \"requester_type_9\";\n    } else {\n      value = value;\n    }\n    var CustomMap = function (findEntry) {\n      generatorWrapper.entryIdCounter = findEntry;\n      return generatorWrapper.entryIdCounter;\n    };\n    generatorWrapper.setTimeoutWrapper = fetchNewToken(value).then(CustomMap);\n    generatorWrapper.tasks = new Timer(7200000);\n    generatorWrapper.handleAsync.window(generatorWrapper.tasks, \"tick\", function () {\n      generatorWrapper.setTimeoutWrapper = fetchNewToken(value).then(CustomMap);\n    });\n    generatorWrapper.tasks.startTimer();\n    executeOrDelayUntilDisposed(generatorWrapper, function () {\n      generatorWrapper.tasks.stopTimer();\n    });\n  };\n  TokenManager.prototype.getAdId = function () {\n    var generatorWrapper = this;\n    return wrapGeneratorToPromise(function (value) {\n      if (value.entryIdCounter == 1) {\n        if (generatorWrapper.entryIdCounter != null && generatorWrapper.entryIdCounter !== EmptyToken) {\n          value.entryIdCounter = 2;\n          value = undefined;\n        } else {\n          value = generatorYield(value, generatorWrapper.setTimeoutWrapper, 3);\n        }\n        return value;\n      }\n      if (value.entryIdCounter != 2) {\n        generatorWrapper.entryIdCounter = value.tasks;\n      }\n      return value.return(generatorWrapper.entryIdCounter);\n    });\n  };\n  var Token = function (generatorWrapper) {\n    this.writeBytes = generatorWrapper;\n  };\n  var EmptyToken = new Token(\"\");\n  var Message = function (generatorWrapper, value, CustomMap, findEntry, iterateEntries) {\n    this.name = generatorWrapper;\n    this.type = value;\n    this.data = CustomMap;\n    this.writeBytes = findEntry;\n    this.entryIdCounter = iterateEntries;\n  };\n  var MessageQueue = function (generatorWrapper) {\n    AdEnvironmentConfig.call(this);\n    this.handleAsync = [];\n    this.tasks = false;\n    this.setTimeoutWrapper = generatorWrapper || \"goog_\" + randomInt++;\n  };\n  inheritPrototype(MessageQueue, AdEnvironmentConfig);\n  MessageQueue.prototype.connect = function () {\n    for (this.tasks = true; this.handleAsync.length !== 0;) {\n      var generatorWrapper = this.handleAsync.shift();\n      if (generatorWrapper) {\n        this.sendMessage(generatorWrapper);\n      }\n    }\n  };\n  var enqueueMessage = function (generatorWrapper, value, CustomMap, findEntry, iterateEntries, createCircularNode) {\n    if (generatorWrapper.tasks) {\n      generatorWrapper.sendMessage(new Message(value, CustomMap, findEntry, iterateEntries, createCircularNode));\n    } else {\n      generatorWrapper.handleAsync.push(new Message(value, CustomMap, findEntry, iterateEntries, createCircularNode));\n    }\n  };\n  MessageQueue.prototype.sendMessage = function () {};\n  var CustomEvent = function (generatorWrapper, value, CustomMap, findEntry, iterateEntries, createCircularNode) {\n    if (undefined === iterateEntries) {\n      iterateEntries = \"\";\n    } else {\n      iterateEntries = iterateEntries;\n    }\n    if (undefined === createCircularNode) {\n      createCircularNode = \"\";\n    } else {\n      createCircularNode = createCircularNode;\n    }\n    AdEvent.call(this, generatorWrapper);\n    this.messageType = value;\n    this.setPrototypeOfPolyfill = CustomMap;\n    this.isAndroid = findEntry;\n    this.origin = iterateEntries;\n    this.writeBytes = createCircularNode;\n  };\n  inheritPrototype(CustomEvent, AdEvent);\n  CustomEvent.prototype.getAdId = function () {\n    return this.writeBytes;\n  };\n  CustomEvent.prototype.toString = function () {\n    return \"\";\n  };\n  var CreativeType = {\n    IMAGE: \"Image\",\n    FLASH: \"Flash\",\n    ALL: \"All\"\n  };\n  var ResourceType = {\n    HTML: \"Html\",\n    IFRAME: \"IFrame\",\n    STATIC: \"Static\",\n    ALL: \"All\"\n  };\n  var SizeCriteria = {\n    IGNORE: \"IgnoreSize\",\n    SELECT_EXACT_MATCH: \"SelectExactMatch\",\n    SELECT_NEAR_MATCH: \"SelectNearMatch\",\n    SELECT_FLUID: \"SelectFluid\"\n  };\n  var CompanionAdSelectionSettings = function () {\n    this.allowCustom = true;\n    this.creativeType = this.resourceType = \"All\";\n    this.sizeCriteria = \"SelectExactMatch\";\n    this.nearMatchPercent = 90;\n    this.adSlotIds = [];\n  };\n  defineNamespace(\"module$exports$google3$javascript$ads$interactivemedia$sdk$clientside$api$companion_ad_selection_settings.CompanionAdSelectionSettings.CreativeType\", CreativeType);\n  defineNamespace(\"module$exports$google3$javascript$ads$interactivemedia$sdk$clientside$api$companion_ad_selection_settings.CompanionAdSelectionSettings.ResourceType\", ResourceType);\n  defineNamespace(\"module$exports$google3$javascript$ads$interactivemedia$sdk$clientside$api$companion_ad_selection_settings.CompanionAdSelectionSettings.SizeCriteria\", SizeCriteria);\n  var CompanionAdSelector = function (generatorWrapper, value) {\n    if (undefined === value) {\n      value = new CompanionAdSelectionSettings();\n    } else {\n      value = value;\n    }\n    this.entryIdCounter = generatorWrapper;\n    if (value) {\n      this.settings = value;\n    } else {\n      this.settings = new CompanionAdSelectionSettings();\n    }\n    if (isValidEnumValue(ResourceType, this.settings.resourceType)) {\n      this.resourceType = this.settings.resourceType;\n    } else {\n      this.resourceType = \"All\";\n    }\n    if (isValidEnumValue(CreativeType, this.settings.creativeType)) {\n      this.creativeType = this.settings.creativeType;\n    } else {\n      this.creativeType = \"All\";\n    }\n    if (isValidEnumValue(SizeCriteria, this.settings.sizeCriteria)) {\n      this.sizeCriteria = this.settings.sizeCriteria;\n    } else {\n      this.sizeCriteria = \"SelectExactMatch\";\n    }\n    if (this.settings.adSlotIds != null) {\n      this.adSlotIds = this.settings.adSlotIds;\n    } else {\n      this.adSlotIds = [];\n    }\n    if (typeof this.settings.nearMatchPercent === \"number\" && this.settings.nearMatchPercent > 0 && this.settings.nearMatchPercent <= 100) {\n      this.nearMatchPercent = this.settings.nearMatchPercent;\n    } else {\n      this.nearMatchPercent = 90;\n    }\n  };\n  var filterCompanionAds = function (generatorWrapper, value) {\n    var CustomMap = [];\n    value.forEach(function (findEntry) {\n      if (generatorWrapper.settings.allowCustom) {\n        if (!isEmptyOrWhitespace(findEntry.getContent()) && (isNaN(findEntry.data.sequenceNumber) || isNaN(findEntry.data.mainAdSequenceNumber) || findEntry.data.mainAdSequenceNumber === findEntry.data.sequenceNumber) && isAdEligible(generatorWrapper, findEntry)) {\n          CustomMap.push(findEntry);\n        } else {\n          findEntry = findEligibleAdVariant(generatorWrapper, findEntry);\n          if (findEntry != null && !isEmptyOrWhitespace(findEntry.getContent())) {\n            CustomMap.push(findEntry);\n          }\n        }\n      }\n    });\n    return CustomMap;\n  };\n  CompanionAdSelector.prototype.PolyfilledMap = function () {\n    return this.resourceType;\n  };\n  var isAdEligible = function (generatorWrapper, value) {\n    var CustomMap;\n    if (CustomMap = value.getContentType() !== \"Flash\") {\n      if (CustomMap = generatorWrapper.resourceType === \"All\" || generatorWrapper.resourceType === value.PolyfilledMap()) {\n        CustomMap = value.getContentType();\n        if (CustomMap == null) {\n          CustomMap = true;\n        } else {\n          CustomMap = generatorWrapper.creativeType === \"All\" || generatorWrapper.creativeType === CustomMap;\n        }\n      }\n      if (CustomMap) {\n        CustomMap = value.getAdSlotId();\n        if (generatorWrapper.adSlotIds.length === 0) {\n          CustomMap = true;\n        } else if (CustomMap != null) {\n          CustomMap = generatorWrapper.adSlotIds.includes(CustomMap);\n        } else {\n          CustomMap = false;\n        }\n      }\n    }\n    if (CustomMap) {\n      CustomMap = value.getRectangleSize();\n      if ((value = !!value.data.fluidSize) || generatorWrapper.entryIdCounter.requiresPolyfill) {\n        generatorWrapper = value && generatorWrapper.entryIdCounter.requiresPolyfill;\n      } else if (generatorWrapper.sizeCriteria === \"IgnoreSize\" || areSizesEqual(generatorWrapper.entryIdCounter.size, CustomMap)) {\n        generatorWrapper = true;\n      } else {\n        if (value = generatorWrapper.sizeCriteria === \"SelectNearMatch\") {\n          value = CustomMap.width;\n          CustomMap = CustomMap.height;\n          if (value > generatorWrapper.entryIdCounter.size.width || CustomMap > generatorWrapper.entryIdCounter.size.height || value < generatorWrapper.nearMatchPercent / 100 * generatorWrapper.entryIdCounter.size.width || CustomMap < generatorWrapper.nearMatchPercent / 100 * generatorWrapper.entryIdCounter.size.height) {\n            value = false;\n          } else {\n            value = true;\n          }\n        }\n        generatorWrapper = value;\n      }\n    } else {\n      generatorWrapper = false;\n    }\n    return generatorWrapper;\n  };\n  var findEligibleAdVariant = function (generatorWrapper, value) {\n    value = getBackupCompanions(value);\n    if (value == null) {\n      return null;\n    } else {\n      return value.find(function (CustomMap) {\n        return isAdEligible(generatorWrapper, CustomMap);\n      }) || null;\n    }\n  };\n  var isValidEnumValue = function (generatorWrapper, value) {\n    return value != null && containsValue(generatorWrapper, value);\n  };\n  var AdError = function (generatorWrapper, value) {\n    this.message = generatorWrapper;\n    this.errorCode = value;\n  };\n  AdError.prototype.getErrorCode = function () {\n    return this.errorCode;\n  };\n  AdError.prototype.getMessage = function () {\n    return this.message;\n  };\n  var errorType = new AdError(\"Failed to initialize ad playback element before starting ad playback.\", 400);\n  var aF = new AdError(\"The provided {0} information: {1} is invalid.\", 1101);\n  function createAdPlayError(generatorWrapper, value) {\n    var CustomMap = undefined === value ? null : value;\n    var findEntry = sliceArguments.apply(2, arguments);\n    if (!(CustomMap instanceof AdError)) {\n      var iterateEntries = generatorWrapper.getErrorCode();\n      var createCircularNode = generatorWrapper.getMessage();\n      if (findEntry.length > 0) {\n        for (var entryIdCounter = 0; entryIdCounter < findEntry.length; entryIdCounter++) {\n          createCircularNode = createCircularNode.replace(new RegExp(\"\\\\{\" + entryIdCounter + \"\\\\}\", \"ig\"), findEntry[entryIdCounter]);\n        }\n      }\n      findEntry = new AdError(\"adPlayError\", createCircularNode, iterateEntries);\n      findEntry.entryIdCounter = CustomMap;\n      CustomMap = findEntry;\n    }\n    return CustomMap;\n  }\n  var debugFlags = {\n    getArrayOrEmpty: false,\n    clearPerformanceMarks: false\n  };\n  var SingletonBase = function () {};\n  SingletonBase.getAdInstance = function () {\n    throw Error(\"Must be overridden\");\n  };\n  var RandomExperimentManager = function () {\n    this.entryIdCounter = 0;\n  };\n  inheritPrototype(RandomExperimentManager, SingletonBase);\n  RandomExperimentManager.userAgentData = undefined;\n  RandomExperimentManager.getAdInstance = function () {\n    if (RandomExperimentManager.userAgentData) {\n      return RandomExperimentManager.userAgentData;\n    } else {\n      return RandomExperimentManager.userAgentData = new RandomExperimentManager();\n    }\n  };\n  function logErrorEvent(generatorWrapper, value, CustomMap, findEntry) {\n    if (undefined === CustomMap) {\n      CustomMap = null;\n    } else {\n      CustomMap = CustomMap;\n    }\n    if (undefined === findEntry) {\n      findEntry = {};\n    } else {\n      findEntry = findEntry;\n    }\n    var iterateEntries = RandomExperimentManager.getAdInstance();\n    if (iterateEntries.entryIdCounter === 0) {\n      if (Math.random() < 0.001) {\n        iterateEntries.entryIdCounter = 2;\n      } else {\n        iterateEntries.entryIdCounter = 1;\n      }\n    }\n    if (iterateEntries.entryIdCounter === 2) {\n      iterateEntries = {};\n      sendBeaconWithParams(Object.assign({}, (iterateEntries.CustomMap = String(generatorWrapper), iterateEntries.isMacOS = String(generatePageViewId()), iterateEntries.em = CustomMap, iterateEntries.lid = value, iterateEntries.eids = getSingletonInstance(BaseClass).entryIdCounter().join(), iterateEntries), findEntry), \"esp\");\n    }\n  }\n  function waitForWindowLoad() {\n    var generatorWrapper = window;\n    var value = undefined === value ? function () {} : value;\n    return new Promise(function (CustomMap) {\n      var findEntry = function () {\n        CustomMap(value());\n        removeEventListenerWithNormalization(generatorWrapper, \"load\", findEntry);\n      };\n      addEventListenerWithNormalization(generatorWrapper, \"load\", findEntry);\n    });\n  }\n  var CacheManager = function () {\n    this.cache = {};\n  };\n  var getCacheManagerInstance = function () {\n    if (!cacheManagerInstance) {\n      cacheManagerInstance = new CacheManager();\n    }\n    return cacheManagerInstance;\n  };\n  var clearCacheManager = function (generatorWrapper) {\n    if (undefined !== generatorWrapper) {\n      for (var value = getIterator(Object.keys(generatorWrapper)), CustomMap = value.next(); !CustomMap.done; CustomMap = value.next()) {\n        CustomMap = CustomMap.value;\n        if (CustomMap.startsWith(\"_GESPSK\")) {\n          try {\n            generatorWrapper.removeItem(CustomMap);\n          } catch (findEntry) {}\n        }\n      }\n    }\n    cacheManagerInstance = new CacheManager();\n  };\n  var evaluateCacheItemState = function (generatorWrapper) {\n    var value = getAdProperty(generatorWrapper, 3);\n    if (!value) {\n      return 3;\n    }\n    if (undefined === getAdPropertyValue(generatorWrapper, 2)) {\n      return 4;\n    }\n    generatorWrapper = Date.now();\n    if (generatorWrapper > value + 259200000) {\n      return 2;\n    } else {\n      if (generatorWrapper > value + 43200000) {\n        return 1;\n      } else {\n        return 0;\n      }\n    }\n  };\n  CacheManager.prototype.get = function (generatorWrapper, value) {\n    if (this.cache[generatorWrapper]) {\n      return {\n        forEachElementReverse: this.cache[generatorWrapper],\n        success: true\n      };\n    }\n    var CustomMap = \"\";\n    try {\n      CustomMap = value.getItem(\"_GESPSK-\" + generatorWrapper);\n    } catch (entryIdCounter) {\n      var findEntry;\n      logErrorEvent(6, generatorWrapper, (findEntry = entryIdCounter) == null ? undefined : findEntry.message);\n      return {\n        forEachElementReverse: null,\n        success: false\n      };\n    }\n    if (!CustomMap) {\n      return {\n        forEachElementReverse: null,\n        success: true\n      };\n    }\n    try {\n      var iterateEntries = Bw(CustomMap);\n      this.cache[generatorWrapper] = iterateEntries;\n      return {\n        forEachElementReverse: iterateEntries,\n        success: true\n      };\n    } catch (entryIdCounter) {\n      var createCircularNode;\n      logErrorEvent(5, generatorWrapper, (createCircularNode = entryIdCounter) == null ? undefined : createCircularNode.message);\n      return {\n        forEachElementReverse: null,\n        success: false\n      };\n    }\n  };\n  CacheManager.prototype.set = function (generatorWrapper, value) {\n    var CustomMap = getAdPropertyValue(generatorWrapper, 1);\n    var findEntry = \"_GESPSK-\" + CustomMap;\n    setAdErrorResponseTimeStamp(generatorWrapper);\n    try {\n      value.setItem(findEntry, serializeData(generatorWrapper));\n    } catch (createCircularNode) {\n      var iterateEntries;\n      logErrorEvent(7, CustomMap, (iterateEntries = createCircularNode) == null ? undefined : iterateEntries.message);\n      return false;\n    }\n    this.cache[CustomMap] = generatorWrapper;\n    return true;\n  };\n  CacheManager.prototype.removeElement = function (generatorWrapper, value) {\n    generatorWrapper = getAdPropertyValue(generatorWrapper, 1);\n    try {\n      value.removeItem(\"_GESPSK-\" + generatorWrapper);\n      delete this.cache[generatorWrapper];\n    } catch (findEntry) {\n      var CustomMap;\n      logErrorEvent(8, generatorWrapper, (CustomMap = findEntry) == null ? undefined : CustomMap.message);\n    }\n  };\n  var cacheManagerInstance = null;\n  function loadCacheItems(generatorWrapper) {\n    var value = new AdRequestConfiguration();\n    if (generatorWrapper) {\n      var CustomMap = [];\n      var findEntry = RegExp(\"^_GESPSK-(.+)$\");\n      try {\n        for (var iterateEntries = 0; iterateEntries < generatorWrapper.length; iterateEntries++) {\n          var createCircularNode = (findEntry.exec(generatorWrapper.key(iterateEntries)) || [])[1];\n          if (createCircularNode) {\n            CustomMap.push(createCircularNode);\n          }\n        }\n      } catch (value) {}\n      CustomMap = getIterator(CustomMap);\n      iterateEntries = CustomMap.next();\n      findEntry = {\n        removeElementAtIndex: undefined\n      };\n      for (findEntry = {}; !iterateEntries.done; iterateEntries = CustomMap.next()) {\n        findEntry.removeElementAtIndex = iterateEntries.value;\n        if ((iterateEntries = getCacheManagerInstance().get(findEntry.removeElementAtIndex, generatorWrapper).forEachElementReverse) && !isDataPresent(value, findEntry.removeElementAtIndex) && (createCircularNode = evaluateCacheItemState(iterateEntries), createCircularNode !== 2 && createCircularNode !== 3)) {\n          setAdProperty(iterateEntries, 9, false);\n          if ((createCircularNode = getAdPropertyValue(iterateEntries, 2)) && createCircularNode.length > 1024) {\n            var entryIdCounter = {};\n            logErrorEvent(55, findEntry.removeElementAtIndex, null, (entryIdCounter.getSessionStorageData = String(createCircularNode.length), entryIdCounter));\n            createCircularNode = iterateEntries.createFunctionWithArguments(createAdError(108));\n            updateElement(createCircularNode, 2);\n          }\n          addElementToAd(value, 2, AdErrorResponse, iterateEntries);\n          iterateEntries = getAdPropertyValue(iterateEntries, 2);\n          entryIdCounter = createCircularNode = undefined;\n          var key = {};\n          logErrorEvent(19, findEntry.removeElementAtIndex, null, (key.incrementPropertyJ = iterateEntries ? \"1\" : \"0\", key.getSessionStorageData = String((entryIdCounter = (createCircularNode = iterateEntries) == null ? undefined : createCircularNode.length) != null ? entryIdCounter : -1), key));\n        }\n      }\n    }\n    if (!parseData(value, AdErrorResponse, 2).length) {\n      return null;\n    }\n    generatorWrapper = {};\n    logErrorEvent(50, \"\", null, (generatorWrapper.mergeAdContainerArrays = String(parseData(value, AdErrorResponse, 2).length), generatorWrapper));\n    return base64Encode(value.entryIdCounter(), 3);\n  }\n  function isDataPresent(generatorWrapper, value) {\n    return parseData(generatorWrapper, AdErrorResponse, 2).some(function (CustomMap) {\n      return getAdPropertyValue(CustomMap, 1) === value && getAdPropertyValue(CustomMap, 2) != null;\n    });\n  }\n  var Deferred = function () {\n    var generatorWrapper = this;\n    this.promise = new Promise(function (value, CustomMap) {\n      generatorWrapper.resolve = value;\n      generatorWrapper.reject = CustomMap;\n    });\n  };\n  var InputError = function (generatorWrapper) {\n    generatorWrapper = Error.call(this, generatorWrapper);\n    this.message = generatorWrapper.message;\n    if (\"stack\" in generatorWrapper) {\n      this.stack = generatorWrapper.stack;\n    }\n    Object.setPrototypeOf(this, InputError.prototype);\n    this.name = \"InputError\";\n  };\n  inheritPrototype(InputError, Error);\n  var BasePromise = function () {\n    this.isEmptyOrWhitespace = false;\n  };\n  var DeferredWithResult = function () {\n    BasePromise.apply(this, arguments);\n    this.errorHandler = new Deferred();\n  };\n  inheritPrototype(DeferredWithResult, BasePromise);\n  var notifyListeners = function (generatorWrapper, value) {\n    if (!generatorWrapper.isEmptyOrWhitespace) {\n      generatorWrapper.isEmptyOrWhitespace = true;\n      generatorWrapper.adServerCatIdWrapper = value;\n      generatorWrapper.errorHandler.resolve(value);\n    }\n  };\n  globalObject.Object.defineProperties(DeferredWithResult.prototype, {\n    promise: {\n      configurable: true,\n      enumerable: true,\n      get() {\n        return this.errorHandler.promise;\n      }\n    },\n    processElements: {\n      configurable: true,\n      enumerable: true,\n      get() {\n        return this.isEmptyOrWhitespace;\n      }\n    },\n    hasError: {\n      configurable: true,\n      enumerable: true,\n      get() {\n        return this.undefinedFunction1;\n      }\n    }\n  });\n  var Result = function () {\n    DeferredWithResult.apply(this, arguments);\n  };\n  inheritPrototype(Result, DeferredWithResult);\n  var resolveResult = function (generatorWrapper, value) {\n    notifyListeners(generatorWrapper, value);\n  };\n  var resolveWithAnotherPromise = function (generatorWrapper, value) {\n    value.then(function (CustomMap) {\n      notifyListeners(generatorWrapper, CustomMap);\n    });\n  };\n  Result.prototype.createFunctionWithArguments = function (generatorWrapper) {\n    if (!this.isEmptyOrWhitespace) {\n      this.isEmptyOrWhitespace = true;\n      this.adServerCatIdWrapper = null;\n      this.undefinedFunction1 = generatorWrapper;\n      this.errorHandler.reject(generatorWrapper);\n    }\n  };\n  var BaseResult = function (generatorWrapper) {\n    this.isEmptyOrWhitespace = false;\n    this.entryIdCounter = generatorWrapper;\n  };\n  inheritPrototype(BaseResult, BasePromise);\n  BaseResult.prototype.processElements = function () {\n    return this.entryIdCounter.isEmptyOrWhitespace;\n  };\n  globalObject.Object.defineProperties(BaseResult.prototype, {\n    hasError: {\n      configurable: true,\n      enumerable: true,\n      get() {\n        return this.entryIdCounter.undefinedFunction1;\n      }\n    }\n  });\n  var SuccessResult = function (generatorWrapper) {\n    BaseResult.call(this, generatorWrapper);\n    this.entryIdCounter = generatorWrapper;\n  };\n  inheritPrototype(SuccessResult, BaseResult);\n  globalObject.Object.defineProperties(SuccessResult.prototype, {\n    value: {\n      configurable: true,\n      enumerable: true,\n      get() {\n        return this.entryIdCounter.adServerCatIdWrapper;\n      }\n    }\n  });\n  var NullableSuccessResult = function (generatorWrapper) {\n    BaseResult.call(this, generatorWrapper);\n    this.entryIdCounter = generatorWrapper;\n  };\n  inheritPrototype(NullableSuccessResult, BaseResult);\n  globalObject.Object.defineProperties(NullableSuccessResult.prototype, {\n    value: {\n      configurable: true,\n      enumerable: true,\n      get() {\n        var generatorWrapper;\n        if ((generatorWrapper = this.entryIdCounter.adServerCatIdWrapper) != null) {\n          return generatorWrapper;\n        } else {\n          return null;\n        }\n      }\n    }\n  });\n  var Notification = function () {\n    DeferredWithResult.apply(this, arguments);\n  };\n  inheritPrototype(Notification, DeferredWithResult);\n  Notification.prototype.notify = function () {\n    notifyListeners(this, null);\n  };\n  var TaskManager = function () {\n    tryCall.apply(this, arguments);\n    this.entryIdCounter = [];\n    this.tasks = [];\n    this.setTimeoutWrapper = [];\n  };\n  inheritPrototype(TaskManager, tryCall);\n  var addTask = function (generatorWrapper, value) {\n    generatorWrapper.tasks.push({\n      isIphoneIpadIpod: false,\n      setCustomProperty: value\n    });\n  };\n  TaskManager.prototype.isIphoneIpadIpod = function (generatorWrapper) {\n    var value = this.tasks.find(function (CustomMap) {\n      return CustomMap.setCustomProperty === generatorWrapper;\n    });\n    if (value) {\n      value.isIphoneIpadIpod = true;\n    }\n  };\n  TaskManager.prototype.getAdEnvironment = function () {\n    this.entryIdCounter.length = 0;\n    this.setTimeoutWrapper.length = 0;\n    this.tasks.length = 0;\n    tryCall.prototype.getAdEnvironment.call(this);\n  };\n  function waitForTasks(generatorWrapper, value) {\n    var CustomMap, findEntry;\n    return wrapGeneratorToPromise(function (iterateEntries) {\n      if (iterateEntries.entryIdCounter == 1) {\n        if (value) {\n          CustomMap = generatorWrapper.filter(function (createCircularNode) {\n            return !createCircularNode.isIphoneIpadIpod;\n          });\n        } else {\n          CustomMap = generatorWrapper;\n        }\n        return generatorYield(iterateEntries, Promise.all(CustomMap.map(function (createCircularNode) {\n          return createCircularN"